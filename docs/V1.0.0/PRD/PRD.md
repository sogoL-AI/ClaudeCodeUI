# ClaudeCodeUI - äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®åç§°
ClaudeCodeUI - Claude ä¼šè¯æ•°æ®å¯è§†åŒ–å¹³å°

### 1.2 é¡¹ç›®èƒŒæ™¯
åŸºäºå·²æœ‰çš„ Claude ä¼šè¯æ•°æ®ï¼Œæ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„ Web åº”ç”¨æ¥å±•ç¤ºå’Œåˆ†æä¼šè¯å†…å®¹ã€‚è¯¥å¹³å°éœ€è¦æ”¯æŒ 400+ ç§ä¸åŒçš„æ¶ˆæ¯ç±»å‹ï¼Œæ¯ç§ç±»å‹éƒ½æœ‰å¯¹åº”çš„è‡ªå®šä¹‰å¯è§†åŒ–ç»„ä»¶ã€‚å½“é‡åˆ°æ–°çš„æ¶ˆæ¯ç±»å‹æ—¶ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–å†™ä¸“é—¨çš„å±•ç¤ºç»„ä»¶ã€‚

### 1.3 é¡¹ç›®ç›®æ ‡
- æä¾›ç›´è§‚çš„ä¼šè¯æ•°æ®å¯è§†åŒ–ç•Œé¢
- æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹çš„ä¸ªæ€§åŒ–å±•ç¤º
- å®ç°é«˜æ€§èƒ½çš„å†…å®¹æ¸²æŸ“å’Œå»é‡
- å»ºç«‹å¯æ‰©å±•çš„ç»„ä»¶æ¶æ„
- æ”¯æŒèŠå¤©æ°”æ³¡å’Œå¡ç‰‡ä¸¤ç§å±•ç¤ºæ¨¡å¼

## 2. æŠ€æœ¯æ¶æ„

### 2.1 æŠ€æœ¯æ ˆ
- **å‰ç«¯æ¡†æ¶**: Next.js 14 + TypeScript
- **UI ç»„ä»¶åº“**: shadcn/ui
- **AI SDK**: Anthropic AI SDK
- **æ ·å¼**: Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Context / Zustand
- **æ„å»ºå·¥å…·**: Vite / Webpack

### 2.2 æ¶æ„è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Session Data  â”‚    â”‚  JSON Key       â”‚    â”‚  Message Type   â”‚
â”‚   (JSON Files)  â”‚â”€â”€â”€â–¶â”‚   Deduplication â”‚â”€â”€â”€â–¶â”‚   Detector      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                        â”‚
                                â–¼                        â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ Component       â”‚    â”‚  Content Hash   â”‚
                       â”‚ Registry        â”‚    â”‚  Generator      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                        â”‚
                                â–¼                        â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  Match Success? â”‚    â”‚  Default JSON   â”‚
                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚  Component      â”‚
                       â”‚  â”‚400+ Message â”‚â”‚    â”‚                 â”‚
                       â”‚  â”‚Components   â”‚â”‚    â”‚                 â”‚
                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚                 â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 é¡¹ç›®ç›®å½•ç»“æ„

```
ClaudeCodeUI/
â”œâ”€â”€ claude-code-ui/                    # ä¸»é¡¹ç›®ç›®å½•
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx               # ä¸»é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx             # æ ¹å¸ƒå±€
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css            # å…¨å±€æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ session-viewer/        # ä¼šè¯æŸ¥çœ‹å™¨é¡µé¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ test/                  # èŠå¤©æ°”æ³¡æµ‹è¯•é¡µé¢
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ combat/                # å®æˆ˜ç»„ä»¶ (ä¸“é—¨åŒ–)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SmartMessageRenderer.tsx  # æ™ºèƒ½æ¶ˆæ¯æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ content-types/     # åŸºç¡€å†…å®¹ç±»å‹
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserMessage.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ fallback/          # é™çº§ç»„ä»¶
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ DefaultJsonMessage.tsx
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ messages/              # æ¶ˆæ¯ç»„ä»¶ (é€šç”¨)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MessageContainer.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ renderers/         # æ¸²æŸ“å™¨
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CodeRenderer.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ JsonRenderer.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MarkdownRenderer.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                # UIç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BadgeGroup.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StatusIndicator.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ utils/             # å·¥å…·ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ContentHash.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Timestamp.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ ui/                    # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ collapsible.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ scroll-area.tsx
â”‚   â”‚   â”‚       â””â”€â”€ separator.tsx
â”‚   â”‚   â””â”€â”€ lib/                       # å·¥å…·åº“
â”‚   â”‚       â”œâ”€â”€ constants/
â”‚   â”‚       â”‚   â””â”€â”€ message-types.ts
â”‚   â”‚       â”œâ”€â”€ types/
â”‚   â”‚       â”‚   â”œâ”€â”€ chat.types.ts      # èŠå¤©ç›¸å…³ç±»å‹
â”‚   â”‚       â”‚   â””â”€â”€ message.types.ts   # æ¶ˆæ¯ç›¸å…³ç±»å‹
â”‚   â”‚       â””â”€â”€ utils/
â”‚   â”‚           â”œâ”€â”€ content-hash.ts
â”‚   â”‚           â”œâ”€â”€ message-utils.ts
â”‚   â”‚           â””â”€â”€ utils.ts
â”‚   â”œâ”€â”€ public/                        # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ session-data.json          # ç¤ºä¾‹ä¼šè¯æ•°æ®
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ package.json                   # é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ tsconfig.json                  # TypeScripté…ç½®
â”‚   â”œâ”€â”€ next.config.ts                 # Next.jsé…ç½®
â”‚   â”œâ”€â”€ tailwind.config.js             # Tailwindé…ç½®
â”‚   â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ docs/                              # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ V1.0.0/
â”‚       â””â”€â”€ PRD/
â”‚           â”œâ”€â”€ PRD.md                 # äº§å“éœ€æ±‚æ–‡æ¡£
â”‚           â””â”€â”€ ComponentDesign.md     # ç»„ä»¶è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ selected_sessions/                 # ä¼šè¯æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ session_01_*.jsonl
â”‚   â”œâ”€â”€ session_02_*.jsonl
â”‚   â””â”€â”€ ...
â”œâ”€â”€ object_types_compact.json          # å¯¹è±¡ç±»å‹å®šä¹‰
â””â”€â”€ session_cc9423cf_extracted_*.json  # ç¤ºä¾‹ä¼šè¯æ•°æ®
```

### 2.4 ç»„ä»¶æ¶æ„è®¾è®¡

#### 2.4.1 æ¶ˆæ¯ç»„ä»¶ (Messages Components)
**ç›®çš„**: é€šç”¨æ¶ˆæ¯å±•ç¤ºç»„ä»¶ï¼Œå¯å¤ç”¨ã€æ ‡å‡†åŒ–
**ä½ç½®**: `src/components/messages/`
**å…³ç³»**: è¢«å®æˆ˜ç»„ä»¶è°ƒç”¨

```
src/components/messages/
â”œâ”€â”€ core/                           # æ ¸å¿ƒç»„ä»¶
â”‚   â”œâ”€â”€ MessageContainer.tsx        # æ¶ˆæ¯å®¹å™¨ (æ”¯æŒèŠå¤©æ°”æ³¡)
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ renderers/                      # æ¸²æŸ“å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ MarkdownRenderer.tsx        # Markdownæ¸²æŸ“å™¨
â”‚   â”œâ”€â”€ CodeRenderer.tsx            # ä»£ç æ¸²æŸ“å™¨
â”‚   â”œâ”€â”€ JsonRenderer.tsx            # JSONæ¸²æŸ“å™¨
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ ui/                             # UIç»„ä»¶
â”‚   â”œâ”€â”€ BadgeGroup.tsx              # æ ‡ç­¾ç»„
â”‚   â”œâ”€â”€ StatusIndicator.tsx         # çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ utils/                          # å·¥å…·ç»„ä»¶
â”‚   â”œâ”€â”€ ContentHash.tsx             # å†…å®¹å“ˆå¸Œç»„ä»¶
â”‚   â”œâ”€â”€ Timestamp.tsx               # æ—¶é—´æˆ³ç»„ä»¶
â”‚   â””â”€â”€ index.ts
â””â”€â”€ index.ts
```

#### 2.4.2 å®æˆ˜ç»„ä»¶ (Combat Components)
**ç›®çš„**: ä¸“é—¨ç”¨äºå±•ç¤ºç‰¹å®šæ¶ˆæ¯ç±»å‹çš„ç»„ä»¶ï¼Œé’ˆå¯¹æ€§å¼ºã€ä¸“é—¨åŒ–
**ä½ç½®**: `src/components/combat/`
**å…³ç³»**: è°ƒç”¨æ¶ˆæ¯ç»„ä»¶

```
src/components/combat/
â”œâ”€â”€ SmartMessageRenderer.tsx        # æ™ºèƒ½æ¶ˆæ¯æ¸²æŸ“å™¨
â”œâ”€â”€ content-types/                  # åŸºç¡€å†…å®¹ç±»å‹ç»„ä»¶
â”‚   â”œâ”€â”€ UserMessage.tsx            # ç”¨æˆ·æ¶ˆæ¯ (æ”¯æŒèŠå¤©æ°”æ³¡)
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ fallback/                      # é™çº§ç»„ä»¶
â”‚   â”œâ”€â”€ DefaultJsonMessage.tsx     # é»˜è®¤JSONå±•ç¤º
â”‚   â””â”€â”€ index.ts
â””â”€â”€ ComponentTemplate.tsx.template  # ç»„ä»¶æ¨¡æ¿
```

## 3. åŠŸèƒ½éœ€æ±‚

### 3.1 æ ¸å¿ƒåŠŸèƒ½

#### 3.1.1 ä¼šè¯æ•°æ®å±•ç¤º
- **åŠŸèƒ½æè¿°**: å±•ç¤ºå®Œæ•´çš„ Claude ä¼šè¯æ•°æ®
- **è¾“å…¥**: JSON æ ¼å¼çš„ä¼šè¯æ–‡ä»¶
- **è¾“å‡º**: å¯è§†åŒ–çš„ä¼šè¯ç•Œé¢
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

#### 3.1.2 èŠå¤©æ°”æ³¡åŠŸèƒ½ â­ æ–°å¢
- **åŠŸèƒ½æè¿°**: æ”¯æŒèŠå¤©æ°”æ³¡å’Œå¡ç‰‡ä¸¤ç§å±•ç¤ºæ¨¡å¼
- **èŠå¤©æ°”æ³¡æ¨¡å¼**:
  - ç”¨æˆ·æ¶ˆæ¯æ˜¾ç¤ºåœ¨å³è¾¹ï¼Œä½¿ç”¨è“è‰²æ°”æ³¡
  - åŠ©æ‰‹æ¶ˆæ¯æ˜¾ç¤ºåœ¨å·¦è¾¹ï¼Œä½¿ç”¨ç°è‰²æ°”æ³¡
  - æ”¯æŒæ°”æ³¡å°¾å·´æ•ˆæœ
  - æ—¶é—´æˆ³å’Œå…ƒæ•°æ®æŒ‰é’®
- **å¡ç‰‡æ¨¡å¼**:
  - ä¼ ç»Ÿå¡ç‰‡æ ·å¼å±•ç¤º
  - å®Œæ•´çš„å…ƒæ•°æ®ä¿¡æ¯
  - å¯æŠ˜å çš„JSONæ•°æ®
- **åˆ‡æ¢åŠŸèƒ½**:
  - å®æ—¶åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼
  - æ”¯æŒä¸»é¢˜åˆ‡æ¢ï¼ˆæµ…è‰²/æ·±è‰²ï¼‰
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

#### 3.1.3 æ¶ˆæ¯ç±»å‹å¤„ç†
- **åŠŸèƒ½æè¿°**: æ”¯æŒ 400+ ç§æ¶ˆæ¯ç±»å‹çš„è‡ªå®šä¹‰å±•ç¤ºç»„ä»¶
- **å¤„ç†æ–¹å¼**:
  - åŸºç¡€æ¶ˆæ¯: user, assistant, system (å·²æœ‰ä¸“é—¨ç»„ä»¶)
  - å†…å®¹ç±»å‹: text, thinking, tool-use, tool-result (å·²æœ‰ä¸“é—¨ç»„ä»¶)
  - ç‰¹æ®Šç±»å‹: meta, sidechain, error, visible-only (å·²æœ‰ä¸“é—¨ç»„ä»¶)
  - æ–°æ¶ˆæ¯ç±»å‹: é‡åˆ°æ—¶ä½¿ç”¨é»˜è®¤JSONå±•ç¤ºï¼Œå¯æ‰‹åŠ¨ç¼–å†™ä¸“é—¨çš„å±•ç¤ºç»„ä»¶
- **ä¼˜å…ˆçº§**: P0 âœ… éƒ¨åˆ†å®ç°

#### 3.1.4 æ™ºèƒ½æ¶ˆæ¯æ¸²æŸ“å™¨
- **åŠŸèƒ½æè¿°**: æ™ºèƒ½ç»„ä»¶åŒ¹é…å’Œé™çº§æ¸²æŸ“
- **åŒ¹é…æ¨¡å¼**:
  - ç³»ç»Ÿå°è¯•åŒ¹é…æ¶ˆæ¯ç±»å‹åˆ°ä¸“é—¨ç»„ä»¶
  - æ”¯æŒå·²å®ç°æ¶ˆæ¯ç±»å‹çš„å®šåˆ¶åŒ–å±•ç¤º
  - æä¾›æœ€ä½³çš„ç”¨æˆ·ä½“éªŒ
- **é™çº§æ¨¡å¼**:
  - å½“æ— æ³•åŒ¹é…æ—¶ï¼Œä½¿ç”¨é»˜è®¤ JSON ç»„ä»¶
  - ç¡®ä¿æ‰€æœ‰æ¶ˆæ¯éƒ½èƒ½æ­£å¸¸æ˜¾ç¤º
  - æä¾›å¯æŠ˜å çš„ JSON æ ‘å½¢ç»“æ„
- **æ‰©å±•æ¨¡å¼**:
  - é‡åˆ°æ–°æ¶ˆæ¯ç±»å‹æ—¶ï¼Œå¯æ‰‹åŠ¨ç¼–å†™ä¸“é—¨çš„å±•ç¤ºç»„ä»¶
  - é€æ­¥æ‰©å±•æ”¯æŒçš„æ¶ˆæ¯ç±»å‹æ•°é‡
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

### 3.2 é¡µé¢åŠŸèƒ½

#### 3.2.1 ä¸»é¡µé¢ (`/`)
- **åŠŸèƒ½æè¿°**: é¡¹ç›®ä»‹ç»å’Œå¯¼èˆª
- **åŠŸèƒ½ç‚¹**:
  - é¡¹ç›®ä»‹ç»å’Œç‰¹æ€§å±•ç¤º
  - æŠ€æœ¯æ ˆæ ‡ç­¾
  - å¯¼èˆªåˆ°ä¼šè¯æŸ¥çœ‹å™¨å’Œæµ‹è¯•é¡µé¢
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

#### 3.2.2 ä¼šè¯æŸ¥çœ‹å™¨ (`/session-viewer`)
- **åŠŸèƒ½æè¿°**: å®Œæ•´çš„ä¼šè¯æ•°æ®å±•ç¤º
- **åŠŸèƒ½ç‚¹**:
  - åŠ è½½å’Œå±•ç¤ºä¼šè¯æ•°æ®
  - ä¸»é¢˜åˆ‡æ¢ï¼ˆæµ…è‰²/æ·±è‰²ï¼‰
  - èŠå¤©æ°”æ³¡/å¡ç‰‡æ¨¡å¼åˆ‡æ¢
  - æ¶ˆæ¯æ—¶é—´çº¿å±•ç¤º
  - ä¼šè¯ä¿¡æ¯ç»Ÿè®¡
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

#### 3.2.3 èŠå¤©æ°”æ³¡æµ‹è¯• (`/test`)
- **åŠŸèƒ½æè¿°**: ä¸“é—¨æµ‹è¯•èŠå¤©æ°”æ³¡åŠŸèƒ½
- **åŠŸèƒ½ç‚¹**:
  - å±•ç¤ºå‰10æ¡æ¶ˆæ¯ç”¨äºæµ‹è¯•
  - å®æ—¶åˆ‡æ¢èŠå¤©æ°”æ³¡/å¡ç‰‡æ¨¡å¼
  - ä¸»é¢˜åˆ‡æ¢
  - åŠŸèƒ½è¯´æ˜å’Œæ¼”ç¤º
- **ä¼˜å…ˆçº§**: P0 âœ… å·²å®ç°

### 3.3 é«˜çº§åŠŸèƒ½

#### 3.3.1 å†…å®¹å»é‡
- **åŠŸèƒ½æè¿°**: ä½¿ç”¨å†…å®¹å“ˆå¸Œé¿å…é‡å¤æ¸²æŸ“
- **å®ç°æ–¹å¼**: SHA-256 å“ˆå¸Œç®—æ³•
- **ä¼˜å…ˆçº§**: P1 âœ… å·²å®ç°

#### 3.3.2 ä¸»é¢˜ç³»ç»Ÿ
- **åŠŸèƒ½æè¿°**: æ”¯æŒæµ…è‰²å’Œæ·±è‰²ä¸»é¢˜
- **å®ç°æ–¹å¼**: Tailwind CSS ä¸»é¢˜åˆ‡æ¢
- **ä¼˜å…ˆçº§**: P1 âœ… å·²å®ç°

#### 3.3.3 å“åº”å¼è®¾è®¡
- **åŠŸèƒ½æè¿°**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- **å®ç°æ–¹å¼**: Tailwind CSS å“åº”å¼ç±»
- **ä¼˜å…ˆçº§**: P1 âœ… å·²å®ç°

## 4. éåŠŸèƒ½éœ€æ±‚

### 4.1 æ€§èƒ½è¦æ±‚
- **é¡µé¢åŠ è½½æ—¶é—´**: < 3ç§’ âœ… å·²å®ç°
- **ç»„ä»¶æ¸²æŸ“æ—¶é—´**: < 100ms âœ… å·²å®ç°
- **å†…å­˜ä½¿ç”¨**: < 100MB âœ… å·²å®ç°
- **å¹¶å‘ç”¨æˆ·**: æ”¯æŒ 100+ ç”¨æˆ·åŒæ—¶è®¿é—®

### 4.2 å…¼å®¹æ€§è¦æ±‚
- **æµè§ˆå™¨æ”¯æŒ**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+ âœ… å·²å®ç°
- **è®¾å¤‡æ”¯æŒ**: æ¡Œé¢ç«¯ã€å¹³æ¿ã€ç§»åŠ¨ç«¯ âœ… å·²å®ç°
- **åˆ†è¾¨ç‡æ”¯æŒ**: 1920x1080 åŠä»¥ä¸Š âœ… å·²å®ç°

### 4.3 å®‰å…¨è¦æ±‚
- **æ•°æ®å®‰å…¨**: æœ¬åœ°å­˜å‚¨ï¼Œä¸ä¸Šä¼ æœåŠ¡å™¨ âœ… å·²å®ç°
- **ä»£ç å®‰å…¨**: å¼€æºé¡¹ç›®ï¼Œéµå¾ªå®‰å…¨æœ€ä½³å®è·µ âœ… å·²å®ç°
- **éšç§ä¿æŠ¤**: ä¸æ”¶é›†ç”¨æˆ·ä¸ªäººä¿¡æ¯ âœ… å·²å®ç°

## 5. ç”¨æˆ·ç•Œé¢è®¾è®¡

### 5.1 èŠå¤©æ°”æ³¡è®¾è®¡ â­ æ–°å¢

#### 5.1.1 ç”¨æˆ·æ¶ˆæ¯æ°”æ³¡
- **ä½ç½®**: å³ä¾§å¯¹é½
- **é¢œè‰²**: è“è‰²èƒŒæ™¯ (`bg-blue-500` / `bg-blue-600`)
- **å½¢çŠ¶**: åœ†è§’çŸ©å½¢ï¼Œå³ä¸‹è§’æœ‰å°å°¾å·´
- **å†…å®¹**: æ¶ˆæ¯æ–‡æœ¬ï¼Œæ”¯æŒMarkdownå’Œä»£ç 
- **å…ƒæ•°æ®**: æ—¶é—´æˆ³ã€å±•å¼€æŒ‰é’®ã€JSONæŸ¥çœ‹æŒ‰é’®

#### 5.1.2 åŠ©æ‰‹æ¶ˆæ¯æ°”æ³¡
- **ä½ç½®**: å·¦ä¾§å¯¹é½
- **é¢œè‰²**: ç°è‰²èƒŒæ™¯ (`bg-gray-100` / `bg-gray-700`)
- **å½¢çŠ¶**: åœ†è§’çŸ©å½¢ï¼Œå·¦ä¸‹è§’æœ‰å°å°¾å·´
- **å†…å®¹**: æ¶ˆæ¯æ–‡æœ¬ï¼Œæ”¯æŒMarkdownå’Œä»£ç 
- **å…ƒæ•°æ®**: æ—¶é—´æˆ³ã€å±•å¼€æŒ‰é’®ã€JSONæŸ¥çœ‹æŒ‰é’®

#### 5.1.3 æ°”æ³¡åˆ‡æ¢
- **åˆ‡æ¢æŒ‰é’®**: å³ä¸Šè§’"èŠå¤©æ°”æ³¡/å¡ç‰‡æ ·å¼"æŒ‰é’®
- **å®æ—¶åˆ‡æ¢**: æ— éœ€åˆ·æ–°é¡µé¢
- **çŠ¶æ€ä¿æŒ**: åˆ‡æ¢çŠ¶æ€åœ¨é¡µé¢åˆ·æ–°åä¿æŒ

### 5.2 æ•´ä½“å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: Logo + Navigation + Theme Toggle + Chat Bubble Toggleâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Main Content: Message Timeline                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Message 1: User Input (Right Bubble)                    â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Message 2: Assistant Response (Left Bubble)             â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Message 3: Tool Usage (Card Style)                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 ç»„ä»¶è®¾è®¡åŸåˆ™
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„è§†è§‰é£æ ¼å’Œäº¤äº’æ¨¡å¼ âœ… å·²å®ç°
- **å¯è¯»æ€§**: æ¸…æ™°çš„ä¿¡æ¯å±‚æ¬¡å’Œå­—ä½“é€‰æ‹© âœ… å·²å®ç°
- **å“åº”å¼**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸ âœ… å·²å®ç°
- **å¯è®¿é—®æ€§**: æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨ âœ… å·²å®ç°

## 6. æ•°æ®æ¨¡å‹

### 6.1 ä¼šè¯æ•°æ®ç»“æ„
```typescript
interface SessionData {
  session_id: string;
  extraction_time: string;
  source_files: Array<{
    file_path: string;
    line_number: number;
    found_at: string;
  }>;
  messages: ChatMessage[];
}

interface ChatMessage {
  uuid?: string;
  type: string;
  message: {
    content: string | ChatContentItem[];
    role?: string;
  };
  timestamp: string;
  parentUuid?: string;
  isSidechain?: boolean;
  isMeta?: boolean;
  isVisibleInTranscriptOnly?: boolean;
  cwd?: string;
  gitBranch?: string;
  version?: string;
}

interface ChatContentItem {
  type: string;
  text?: string;
  tool_use_id?: string;
  content?: unknown;
  is_error?: boolean;
}
```

### 6.2 ç»„ä»¶æ•°æ®ç»“æ„
```typescript
interface MessageComponentProps {
  message: ChatMessage;
  sessionId: string;
  theme?: 'light' | 'dark';
  isExpanded?: boolean;
  onToggleExpand?: () => void;
  useChatBubble?: boolean; // æ–°å¢ï¼šèŠå¤©æ°”æ³¡æ§åˆ¶
}

interface MessageContainerProps {
  message: ChatMessage;
  sessionId: string;
  theme?: 'light' | 'dark';
  onViewJson?: () => void;
  isExpanded?: boolean;
  onToggleExpand?: () => void;
  borderColor?: string;
  customHeader?: React.ReactNode;
  showMetadata?: boolean;
  children?: React.ReactNode;
  isUserMessage?: boolean;
  contentHash?: string;
  useChatBubble?: boolean; // æ–°å¢ï¼šèŠå¤©æ°”æ³¡æ§åˆ¶
}
```

### 6.3 èŠå¤©æ°”æ³¡æ•°æ®ç»“æ„ â­ æ–°å¢
```typescript
// èŠå¤©æ°”æ³¡é…ç½®
interface ChatBubbleConfig {
  isUser: boolean;
  theme: 'light' | 'dark';
  useChatBubble: boolean;
  content: React.ReactNode;
  timestamp: string;
  showMetadata: boolean;
}

// æ°”æ³¡æ ·å¼é…ç½®
interface BubbleStyleConfig {
  userBubble: {
    light: string; // Tailwind CSS classes
    dark: string;
  };
  assistantBubble: {
    light: string;
    dark: string;
  };
  tailPosition: 'left' | 'right';
}
```

## 7. å¼€å‘è®¡åˆ’

### 7.1 ç¬¬ä¸€é˜¶æ®µ âœ… å·²å®Œæˆ (Week 1-2)
- [x] é¡¹ç›®åˆå§‹åŒ–å’ŒåŸºç¡€æ¶æ„æ­å»º
- [x] æ ¸å¿ƒæ¶ˆæ¯ç±»å‹ç»„ä»¶å¼€å‘ (user, assistant, system)
- [x] åŸºç¡€ UI æ¡†æ¶é›†æˆ
- [x] èŠå¤©æ°”æ³¡åŠŸèƒ½å®ç°
- [x] æ™ºèƒ½æ¶ˆæ¯æ¸²æŸ“å™¨å®ç°

### 7.2 ç¬¬äºŒé˜¶æ®µ ğŸ”„ è¿›è¡Œä¸­ (Week 3-4)
- [x] å†…å®¹ç±»å‹ç»„ä»¶å¼€å‘ (text, thinking, tool-use, tool-result)
- [x] ç‰¹æ®Šæ¶ˆæ¯ç±»å‹ç»„ä»¶å¼€å‘
- [x] ç»„ä»¶æ³¨å†Œç³»ç»Ÿå®ç°
- [x] æ–°æ¶ˆæ¯ç±»å‹ç»„ä»¶çš„æ‰‹åŠ¨å¼€å‘æµç¨‹
- [ ] æ›´å¤šæ¶ˆæ¯ç±»å‹ç»„ä»¶å¼€å‘

### 7.3 ç¬¬ä¸‰é˜¶æ®µ ğŸ“‹ è®¡åˆ’ä¸­ (Week 5-6)
- [ ] æ ¹æ®å®é™…æ•°æ®é€æ­¥å¼€å‘æ–°çš„æ¶ˆæ¯ç±»å‹ç»„ä»¶
- [ ] å†…å®¹å“ˆå¸Œå»é‡ç³»ç»Ÿä¼˜åŒ–
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•
- [ ] ç»„ä»¶å¼€å‘æ¨¡æ¿å’Œè§„èŒƒå®Œå–„

### 7.4 ç¬¬å››é˜¶æ®µ ğŸ“‹ è®¡åˆ’ä¸­ (Week 7-8)
- [ ] é«˜çº§åŠŸèƒ½å¼€å‘
- [ ] ç”¨æˆ·ç•Œé¢ä¼˜åŒ–
- [ ] æ–‡æ¡£ç¼–å†™å’Œéƒ¨ç½²
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†å’Œè¿­ä»£

## 8. é£é™©è¯„ä¼°

### 8.1 æŠ€æœ¯é£é™©
- **é£é™©**: å¤§é‡æ¶ˆæ¯ç±»å‹éœ€è¦ä¸“é—¨çš„å±•ç¤ºç»„ä»¶
- **ç¼“è§£**: ä½¿ç”¨é»˜è®¤JSONç»„ä»¶ä½œä¸ºé™çº§æ–¹æ¡ˆï¼Œé€æ­¥å¼€å‘ä¸“é—¨ç»„ä»¶ âœ… å·²å®ç°
- **å½±å“**: å¼€å‘å‘¨æœŸå¯æ§ï¼Œç”¨æˆ·ä½“éªŒé€æ­¥æå‡

### 8.2 æ€§èƒ½é£é™©
- **é£é™©**: å¤§é‡ç»„ä»¶å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜
- **ç¼“è§£**: å®ç°æ‡’åŠ è½½å’Œè™šæ‹Ÿæ»šåŠ¨
- **å½±å“**: ç”¨æˆ·ä½“éªŒä¸‹é™

### 8.3 ç»´æŠ¤é£é™©
- **é£é™©**: ç»„ä»¶æ•°é‡è¿‡å¤šéš¾ä»¥ç»´æŠ¤
- **ç¼“è§£**: å»ºç«‹å®Œå–„çš„æ–‡æ¡£å’Œæµ‹è¯•ä½“ç³»
- **å½±å“**: é•¿æœŸç»´æŠ¤æˆæœ¬å¢åŠ 

## 9. æˆåŠŸæŒ‡æ ‡

### 9.1 æŠ€æœ¯æŒ‡æ ‡
- [x] æ”¯æŒå·²å®ç°æ¶ˆæ¯ç±»å‹çš„ä¸“é—¨å±•ç¤º
- [x] æ–°æ¶ˆæ¯ç±»å‹ä½¿ç”¨é»˜è®¤JSONå±•ç¤º
- [x] é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- [x] ç»„ä»¶æ¸²æŸ“æ—¶é—´ < 100ms
- [x] èŠå¤©æ°”æ³¡åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] ä»£ç è¦†ç›–ç‡ > 80%

### 9.2 ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
- [x] ç•Œé¢å“åº”æ—¶é—´ < 200ms
- [x] æ”¯æŒä¸»æµæµè§ˆå™¨
- [x] ç§»åŠ¨ç«¯é€‚é…è‰¯å¥½
- [x] èŠå¤©æ°”æ³¡/å¡ç‰‡æ¨¡å¼åˆ‡æ¢æµç•…
- [x] ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- [ ] æ— éšœç¢è®¿é—®æ”¯æŒ

### 9.3 ä¸šåŠ¡æŒ‡æ ‡
- [x] é¡¹ç›®æŒ‰æ—¶äº¤ä»˜
- [x] ä»£ç è´¨é‡è¾¾æ ‡
- [x] æ–‡æ¡£å®Œæ•´æ€§
- [ ] ç”¨æˆ·æ»¡æ„åº¦

## 10. é™„å½•

### 10.1 æœ¯è¯­è¡¨
- **Session**: Claude ä¼šè¯æ•°æ®
- **Message**: ä¼šè¯ä¸­çš„å•æ¡æ¶ˆæ¯
- **Component**: æ¶ˆæ¯æ¸²æŸ“ç»„ä»¶
- **Content Hash**: å†…å®¹å“ˆå¸Œå€¼
- **Type Registry**: ç±»å‹æ³¨å†Œè¡¨
- **Default JSON Component**: é»˜è®¤JSONå±•ç¤ºç»„ä»¶
- **Specialized Component**: ä¸“é—¨çš„æ¶ˆæ¯å±•ç¤ºç»„ä»¶
- **Chat Bubble**: èŠå¤©æ°”æ³¡æ ·å¼
- **SmartMessageRenderer**: æ™ºèƒ½æ¶ˆæ¯æ¸²æŸ“å™¨

### 10.2 æ–°å¢åŠŸèƒ½è¯´æ˜ â­

#### 10.2.1 èŠå¤©æ°”æ³¡åŠŸèƒ½
- **å®ç°ä½ç½®**: `src/components/messages/core/MessageContainer.tsx`
- **æ§åˆ¶å‚æ•°**: `useChatBubble` boolean å‚æ•°
- **æ ·å¼ç³»ç»Ÿ**: Tailwind CSS å“åº”å¼è®¾è®¡
- **ä¸»é¢˜æ”¯æŒ**: æµ…è‰²/æ·±è‰²ä¸»é¢˜é€‚é…
- **åˆ‡æ¢æœºåˆ¶**: å®æ—¶åˆ‡æ¢ï¼Œæ— éœ€åˆ·æ–°

#### 10.2.2 æµ‹è¯•é¡µé¢
- **è®¿é—®è·¯å¾„**: `/test`
- **åŠŸèƒ½**: ä¸“é—¨æµ‹è¯•èŠå¤©æ°”æ³¡åŠŸèƒ½
- **æ•°æ®**: ä½¿ç”¨å‰10æ¡æ¶ˆæ¯è¿›è¡Œæµ‹è¯•
- **åˆ‡æ¢**: æ”¯æŒå®æ—¶æ¨¡å¼åˆ‡æ¢

### 10.3 å‚è€ƒæ–‡æ¡£
- [Next.js å®˜æ–¹æ–‡æ¡£](https://nextjs.org/docs)
- [shadcn/ui ç»„ä»¶åº“](https://ui.shadcn.com/)
- [Anthropic AI SDK](https://sdk.anthropic.com/)
- [Tailwind CSS](https://tailwindcss.com/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: V1.1.0  
**åˆ›å»ºæ—¶é—´**: 2025-01-31  
**æœ€åæ›´æ–°**: 2025-08-02  
**è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ  
**æ›´æ–°å†…å®¹**: åŒæ­¥èŠå¤©æ°”æ³¡åŠŸèƒ½ã€é¡¹ç›®ç»“æ„é‡æ„ã€å®é™…å®ç°çŠ¶æ€
